---
layout: post
title:  "ReactJS 初探"
date:   2015-01-01 11:21:00
categories: Note
tag: "笔记、总结" 
desc: "ReactJS 近来大红大紫，Angular 背后大山是 Google, React 的大山是 Facebook,都是互联网大佬啊。于是我忍不住也来捣鼓捣鼓，它有哪些亮点呢？好用不？实用不？"
imgUrl: "data/post_thumb/reactjs.png"
---

![reactjs](/data/post_imgs/reactjs.png)

ReactJS 近来大红大紫，Angular 背后大山是 Google, React 的大山是 Facebook,都是互联网大佬啊。于是我忍不住也来捣鼓捣鼓，它有哪些亮点呢？好用不？实用不？

# 亮点

虚拟 DOM

# 和 Angular 有什么不同？

- Angular 是 SPA－单页面网站；
- Angular 依赖于 XHR，根据返回的数据，重新渲染部分页面；
- Angular 依赖 template。其实应该比较直观吧？
- Angular 是双工绑定， 而 React 推崇单向数据流；

# JSX是什么？



# 基础用法

- `React.createClass` 
	- 构造函数。

- `React.render` 
	- 实例化。

- JSX and React.DOM
	- 两种不同的写法风格，倾向于 JSX,因为更能看出 DOM 结构来。

- state
	- 根据 state 的变化，渲染 DOM；
	- 想修改 state 的值，通过`setState()`函数去修改；
	- `setState()` 触发 reconciliation 过程，创建或者更新虚拟 DOM。

- props
	- state 变化时候，通过 props,自上而下地影响，让子类跟着变化；
	- 通过 props，连通父类和子类。“ owner 的说法挺有意思”；
	- `propTypes:{}` 可做格式验证。

- event
	- 是 React 自己合成的 event；
	- delegation 形式放在 top level 结点中；
	- 自动绑定了 this 上下文。

- refs
	- 通过设置 ref 属性，使父类可获取到子类的 DOM 结点；
	- 设置 ref 后，注意 ref 返回的那个对象也是个 component；
	- `getDOMNode()` 返回真实的 DOM 结点。

# 通信

- 单向数据流 － One-way direction flow of data
- 实现原理
	- 利用 prop 传递 callback 函数来实现子类向父类通信。
- 与双工绑定比较
	- Angular 是双工绑定的形式，当出现如计算值的时候，需要 $watch 多个 input, 当数据变化时候，无法清晰地判断出是哪一个 input 引起的更新；
	- React 可模拟双工绑定，但本质还是数据从上自下的单项传递，这样的方式使得数据很清晰；
	- 可使用 addons 简化代码。以及其他简化形式`<Component {...this.props} more="values" />`。

# Add-ons -实用工具集
	
- LinkedStateMixin: 简化了表单输入框数据与 state 间的逻辑，本质是封装了一下 onchange/setState()等系列操作 
	- 用法：
		- 引入： `mixins: [React.addons.LinkedStateMixin]`；
		- 属性： `valueLink={this.linkState('xxx')}`。

# Component Lifecycle

1. Mounting
	- `componentWillMount`
	- `componentDidMount`
2. Updating
	- `componentWillReceiveProps`
	- `shouldComponentUpdate` 返回 Boolean 值
3. Unmounting
	- `componentWillUnmount`

# 使用 React 构建一个实时投票应用

![react-voting](/data/post_imgs/react-voting.png)

1. 描述

一个使用 React.js 做的简易投票系统，可新增项目、为项目投票，并实时渲染投票结果。

2. 启动
`gulp serve`


3. 基本架构

	main
		> addbutton
		> feedform
		> feedlist
			> feeditem

4. 添加事件
	1. 顶级模块与子类模块的通信：
		- 和 `<AddBtn>` 的通信： isShowBtn, onButtonClick();
		- 和 `<FeedForm>` 的通信： isShowForm;
		- 和 `<FeedItem>` `<FeedList>` 的通信： onVote();	
		- 和 `<FeedForm>` 的通信： onNewItem().

	2. 交互
		1. 按钮
			- 点击 add 按钮，toggle 表单的展现，同时改变按钮的样式和文字
		2. 表单
			- 填写 `title` 和 `desc` ，点击按钮，grid 中即时新增一条记录。同时重置 form。
			- refs: `title`, `desc`, `form`; 注意写法： `this.refs.title.getDOMNode().value`
		3. 箭头
			- 点击上下按钮增减投票数，低于0票时显示红色样式

5. [代码](https://github.com/heydelilah/exercises-FrontendFramework/tree/master/react-voteit)

# 相关工具

- Gulp -task runner
- [Firebase](https://www.firebase.com/) - Realtime Database
	- 安装： 
		- `npm install firebase`
	- 特性
		- Realtime Database
			- 主动推送，是基于websocket的吗？
		- Stored as JSON objects
	- 方法
		- 引入： `new Firebase('https://react-vote.firebaseio.com/);`
		- 监听： on('value', function(){})
		- 新增： .push()
		- 更新： .update()
		- 过滤： .child()
- [Lo-Dash](https://lodash.com/docs) -  JS 工具库
	- uniq();
	- findIndex(array, {attr: value}); 返回index;
	- pull() 删除数组里的某个值.
	- sortBy();

		var sorted = _.sortBy(items, function(n){
			return -n.number;
		})


# 相关资源

- [Reactjs官网](https://facebook.github.io/react/)
- [tuts+ : Intro to the React Framework －by Pavan Podila －15 Nov 2013](https://code.tutsplus.com/tutorials/intro-to-the-react-framework--net-35660)
- [tuts+ : 视频教程 －Getting Started With React.js](https://code.tutsplus.com/courses/getting-started-with-reactjs/lessons/jsx-vs-reactdom)
- 0.12改动 https://facebook.github.io/react/blog/2014/10/28/react-v0.12.html




